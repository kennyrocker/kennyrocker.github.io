function TimeLine(){var t=this,i=document.querySelector(".parallax");this.propsObj={parllaxEleCountNum:10,parallaxNum:.7,transTimeNum:1e3,pointerNum:0,currentPanelId:0,parallaxOffsetNum:50,resizeTimeout:!1,resizeDelta:200,parallaxEleTopArr:[],triggerArr:[],stopHeightNum:void 0,contentHeightNum:void 0,contentWidthNum:void 0,initPointerHeightNum:void 0,initScrollNum:void 0,stopCountNum:void 0,lastPanelEq:void 0,compareTime:void 0},this.setProps=function(){var t=$(".stop"),i=$(".content");this.propsObj.stopHeightNum=t.eq(0).height(),this.propsObj.contentHeightNum=i.height(),this.propsObj.contentWidthNum=i.width(),this.propsObj.initPointerHeightNum=this.propsObj.stopHeightNum/2,this.propsObj.initScrollNum=this.propsObj.stopHeightNum/2,this.propsObj.stopCountNum=t.size(),this.propsObj.lastPanelEq=this.propsObj.stopCountNum-1},this.drawStage=function(){$(".pointer").css("height",this.propsObj.initPointerHeightNum-13+"px");var t=$(".cycle");t.css("top",this.propsObj.initPointerHeightNum-35+"px"),t.css("left",(this.propsObj.contentWidthNum-70)/2+"px"),$(".mark").css("margin-top",this.propsObj.initPointerHeightNum+"px")},this.setTriggers=function(){$(".stop").each(function(){var i=$(this).position().top;t.propsObj.triggerArr.push(i)})},this.drawParallax=function(){this.drawParallaxElements(this.propsObj.parllaxEleCountNum),this.initParallaxEleTopArr();var i=this.propsObj.contentWidthNum-$(".element").eq(0).width(),s=0;$(".parallax .element").each(function(){$(this).css("left",t.getRandomInt(0,i)+"px"),$(this).css("top",t.propsObj.parallaxEleTopArr[s]+"px"),s++})},this.drawParallaxElements=function(t){for(var i="",s=0;s<t;s++)i+="<div id='ele_"+s+"' class='element'></div>";$(".parallax").html(i)},this.initParallaxEleTopArr=function(){for(var t=this.propsObj.contentHeightNum/this.propsObj.parllaxEleCountNum,i=this.propsObj.parallaxOffsetNum,s=0;s<this.propsObj.parllaxEleCountNum;s++){var r=Math.floor(this.getRandomInt(t*s,t*s+i));this.propsObj.parallaxEleTopArr.push(r)}},this.manageParallax=function(){var t=0-(this.propsObj.pointerNum-this.propsObj.initPointerHeightNum)*this.propsObj.parallaxNum;i.style.top=t+"px"},this.manageControl=function(){0===this.propsObj.currentPanelId?$(".arrow.up").fadeOut(this.propsObj.transTimeNum/2):-1===this.propsObj.currentPanelId?$(".arrow.down").fadeOut(this.propsObj.transTimeNum/2):$(".arrow.down, .arrow.up").show()},this.matainState=function(){var t=this.propsObj.pointerNum,i=this.propsObj.triggerArr,s=this.propsObj.lastPanelEq;if(t>0&&t<i[1])this.managePanel(0),this.propsObj.currentPanelId=0;else if(t>i[s])this.managePanel(-1),this.propsObj.currentPanelId=-1;else{var r;for(r=1;r<s;r++)t>i[r]&&t<i[r+1]&&(this.managePanel(r),this.propsObj.currentPanelId=r)}},this.managePanel=function(t){this.propsObj.currentPanelId!==t&&this.displayPanel(t)},this.displayPanel=function(t){-1===t&&(t=this.propsObj.lastPanelEq);var i=$(".stop .info");i.fadeOut(this.propsObj.transTimeNum),i.eq(t).fadeIn(this.propsObj.transTimeNum)},this.initInterval=function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},function i(){requestAnimFrame(i),t.renderFrame()}()},this.renderFrame=function(){var t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;this.propsObj.pointerNum=this.propsObj.initScrollNum+t,this.matainState(),this.manageParallax(),this.manageControl()},this.getRandomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},this.init=function(){$(".stop").css("height",$(window).height()+"px"),this.setProps(),this.drawStage(),this.setTriggers(),this.drawParallax(),this.initInterval(),this.addEvents(),this.displayPanel(this.propsObj.currentPanelId)},this.scrollNextStop=function(){var i;(i=-1!==this.propsObj.currentPanelId?this.propsObj.currentPanelId+1:this.propsObj.lastPanelEq+1)<=this.propsObj.lastPanelEq&&$("html, body").stop().animate({scrollTop:t.propsObj.triggerArr[i]},t.propsObj.transTimeNum,"swing")},this.scrollPreviusStop=function(){var i;(i=-1===this.propsObj.currentPanelId?this.propsObj.lastPanelEq-1:this.propsObj.currentPanelId-1)>=0&&$("html, body").stop().animate({scrollTop:t.propsObj.triggerArr[i]},t.propsObj.transTimeNum,"swing")},this.resizeEnd=function(){new Date-this.propsObj.compareTime<this.propsObj.resizeDelta?setTimeout(t.resizeEnd,t.propsObj.resizeDelta):(this.propsObj.resizeTimeout=!1,t.reInit())},this.reInit=function(){this.propsObj.triggerArr=[],$(".stop").css("height",$(window).height()+"px"),this.setProps(),this.drawStage(),this.setTriggers()},this.addEvents=function(){$(".arrow.down").bind("click",function(){t.scrollNextStop()}),$(".arrow.up").bind("click",function(){t.scrollPreviusStop()}),$(window).resize(function(){t.propsObj.compareTime=new Date,!1===t.propsObj.resizeTimeout&&(t.propsObj.resizeTimeout=!0,setTimeout(t.resizeEnd,t.propsObj.resizeDelta))})},this.init()}
