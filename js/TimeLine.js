function TimeLine(t){var s=this,e=document.querySelector(".parallax");this.propsObj={parllaxEleCountNum:10,parallaxNum:.7,transTimeNum:1e3,pointerNum:0,currentPanelId:0,parallaxOffsetNum:50,resizeTimeout:!1,resizeDelta:200,parallaxEleTopArr:[],triggerArr:[],stopHeightNum:void 0,contentHeightNum:void 0,contentWidthNum:void 0,initPointerHeightNum:void 0,initScrollNum:void 0,stopCountNum:void 0,lastPanelEq:void 0,compareTime:void 0},this.setProps=function(){this.propsObj.stopHeightNum=$(".stop").eq(0).height(),this.propsObj.contentHeightNum=$(".content").height(),this.propsObj.contentWidthNum=$(".content").width(),this.propsObj.initPointerHeightNum=this.propsObj.stopHeightNum/2,this.propsObj.initScrollNum=this.propsObj.stopHeightNum/2,this.propsObj.stopCountNum=$(".stop").size(),this.propsObj.lastPanelEq=this.propsObj.stopCountNum-1},this.drawStage=function(){$(".pointer").css("height",this.propsObj.initPointerHeightNum-13+"px"),$(".cycle").css("top",this.propsObj.initPointerHeightNum-35+"px"),$(".cycle").css("left",(this.propsObj.contentWidthNum-70)/2+"px"),$(".mark").css("margin-top",this.propsObj.initPointerHeightNum+"px")},this.setTriggers=function(){$(".stop").each(function(){var t=$(this).position().top;s.propsObj.triggerArr.push(t)})},this.drawParallax=function(){this.drawParallaxElements(this.propsObj.parllaxEleCountNum),this.initParallaxEleTopArr();var t=this.propsObj.contentWidthNum-$(".element").eq(0).width(),i=0;$(".parallax .element").each(function(){$(this).css("left",s.getRandomInt(0,t)+"px"),$(this).css("top",s.propsObj.parallaxEleTopArr[i]+"px"),i++})},this.drawParallaxElements=function(t){for(var i="",s=0;s<t;s++)i+="<div id='ele_"+s+"' class='element'></div>";$(".parallax").html(i)},this.initParallaxEleTopArr=function(){for(var t=this.propsObj.contentHeightNum/this.propsObj.parllaxEleCountNum,i=this.propsObj.parallaxOffsetNum,s=0;s<this.propsObj.parllaxEleCountNum;s++){var e=Math.floor(this.getRandomInt(t*s,t*s+i));this.propsObj.parallaxEleTopArr.push(e)}},this.manageParallax=function(){var t=this.propsObj.pointerNum,i=(this.propsObj.contentHeightNum,0-(t-this.propsObj.initPointerHeightNum)*this.propsObj.parallaxNum);e.style.top=i+"px"},this.manageControl=function(){0==this.propsObj.currentPanelId?$(".arrow.up").fadeOut(this.propsObj.transTimeNum/2):-1==this.propsObj.currentPanelId?$(".arrow.down").fadeOut(this.propsObj.transTimeNum/2):$(".arrow.down, .arrow.up").show()},this.matainState=function(){var t=this.propsObj.pointerNum,i=this.propsObj.triggerArr,s=this.propsObj.lastPanelEq;if(0<t&&t<i[1])this.managePanel(0),this.propsObj.currentPanelId=0;else if(t>i[s])this.managePanel(-1),this.propsObj.currentPanelId=-1;else{var e;for(e=1;e<s;e++)t>i[e]&&t<i[e+1]&&(this.managePanel(e),this.propsObj.currentPanelId=e)}},this.managePanel=function(t){this.propsObj.currentPanelId!==t&&this.displayPanel(t)},this.displayPanel=function(t){-1==t&&(t=this.propsObj.lastPanelEq),$(".stop .info").fadeOut(this.propsObj.transTimeNum),$(".stop .info").eq(t).fadeIn(this.propsObj.transTimeNum)},this.initInterval=function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},function t(){requestAnimFrame(t),s.renderFrame()}()},this.renderFrame=function(){var t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,i=this.propsObj.initScrollNum+t;this.propsObj.pointerNum=i,this.matainState(),this.manageParallax(),this.manageControl()},this.getRandomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},this.init=function(t){$(".stop").css("height",$(window).height()+"px"),this.setProps(),this.drawStage(),this.setTriggers(),this.drawParallax(),this.initInterval(),this.addEvents(),this.displayPanel(this.propsObj.currentPanelId)},this.scrollNextStop=function(){var t;(t=-1!==this.propsObj.currentPanelId?this.propsObj.currentPanelId+1:this.propsObj.lastPanelEq+1)<=this.propsObj.lastPanelEq&&$("html, body").stop().animate({scrollTop:s.propsObj.triggerArr[t]},s.propsObj.transTimeNum,"swing")},this.scrollPreviusStop=function(){var t;0<=(t=-1==this.propsObj.currentPanelId?this.propsObj.lastPanelEq-1:this.propsObj.currentPanelId-1)&&$("html, body").stop().animate({scrollTop:s.propsObj.triggerArr[t]},s.propsObj.transTimeNum,"swing")},this.resizeEnd=function(){new Date-this.propsObj.compareTime<this.propsObj.resizeDelta?setTimeout(s.resizeEnd,s.propsObj.resizeDelta):(this.propsObj.resizeTimeout=!1,s.reInit())},this.reInit=function(){this.propsObj.triggerArr=[],$(".stop").css("height",$(window).height()+"px"),this.setProps(),this.drawStage(),this.setTriggers()},this.addEvents=function(){$(".arrow.down").bind("click",function(){s.scrollNextStop()}),$(".arrow.up").bind("click",function(){s.scrollPreviusStop()}),$(window).resize(function(){s.propsObj.compareTime=new Date,!1===s.propsObj.resizeTimeout&&(s.propsObj.resizeTimeout=!0,setTimeout(s.resizeEnd,s.propsObj.resizeDelta))})},this.removeEvents=function(){$(".arrow.down").unbind("click"),$(".arrow.up").unbind("click")},this.destory=function(){this.removeEvents()},this.init(t)}